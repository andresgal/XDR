// to filter by DeviceName use this line
// where DeviceName == 'client2' and ActionType startswith 'ExploitGuard'
let politicatable = DeviceEvents 
| where ActionType startswith 'ExploitGuard'
| extend Politica = parse_json(ActionType)
| extend Politica = iif(tostring(Politica[0][0])== 'ExploitGuardWin32SystemCallBlocked', 'Win32k system calls', iif(tostring(Politica[0][0])== 'ExploitGuardAcgEnforced', 'Arbitrary code guard (ACG)',iif(tostring(Politica[0][0])== 'ExploitGuardNonMicrosoftSignedBlocked', 'Code integrity guard',iif(tostring(Politica[0][0])== 'ExploitGuardNonMicrosoftSignedBlocked', 'Code integrity guard','Unknown'))))
| project DeviceName, Politica; 
DeviceEvents |
 where ActionType startswith 'ExploitGuard'
| summarize count() by ActionType, FileName, Timestamp, DeviceName, InitiatingProcessFileName, ProcessCommandLine, InitiatingProcessFolderPath, InitiatingProcessParentFileName, InitiatingProcessVersionInfoCompanyName, InitiatingProcessVersionInfoFileDescription, InitiatingProcessVersionInfoOriginalFileName, InitiatingProcessVersionInfoInternalFileName, InitiatingProcessVersionInfoProductName, InitiatingProcessVersionInfoProductVersion, RegistryValueName, RegistryKey, RegistryValueData
|  order by Timestamp,count_,DeviceName desc

